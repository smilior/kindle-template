# /ebook-review — 校正・校閲

校正者と校閲者のSubAgentを並列起動してレビューする。
引数: 書籍スラッグ [章番号|"all"]（例: `/ebook-review ai-business-guide 3`）

## 手順

1. `books/{slug}/book.yaml` を読み込む
2. 対象章を決定する（章番号指定 / all / 未指定なら status: writing の全章）
3. 対象の各章について、校正者と校閲者のSubAgentを**並列**で起動する

### 各章ごとに2つのSubAgentを並列起動

#### 校正者（Proofreader）SubAgent

- `subagent_type: "general-purpose"`
- プロンプト内容：

```
あなたはプロの校正者です。電子書籍の第{N}章を校正してください。

【書籍情報】
{book.yamlの内容}

【対象ファイル】
books/{slug}/chapters/{NN}-chapter.md を読み込んで校正してください。

【校正観点】
1. 誤字脱字の発見と修正
2. 文法の誤り（主語述語の不一致、助詞の誤用など）
3. 表記ゆれの統一（数字の全角半角、カタカナ表記など）
4. 句読点の適切な使用
5. 文体の統一（{tone}で統一されているか）
6. 不自然な言い回しの改善
7. 冗長な表現の簡潔化

【出力】
1. 校正済みの本文を books/{slug}/chapters/{NN}-chapter.md に上書き保存すること
2. 修正箇所のサマリーを books/{slug}/reviews/proofread-ch{NN}.md に書き込むこと
   形式:
   ## 第{N}章 校正レポート
   ### 修正件数: X件
   ### 修正内容
   - 修正1: 「誤」→「正」（理由）
   - 修正2: ...
```

#### 校閲者（Content Editor）SubAgent

- `subagent_type: "general-purpose"`
- プロンプト内容：

```
あなたはプロの校閲者です。電子書籍の第{N}章を校閲してください。

【書籍情報】
{book.yamlの内容}

【アウトライン】
{outline.mdの該当章セクション}

【対象ファイル】
books/{slug}/chapters/{NN}-chapter.md を読み込んで校閲してください。

【校閲観点】
1. 内容の正確性（事実誤認がないか）
2. 論理の一貫性（矛盾や飛躍がないか）
3. アウトラインとの整合性（キーポイントが網羅されているか）
4. 読者体験（読者が飽きない展開か、難しい概念に十分な説明があるか）
5. 具体例の適切さ（例が主張を補強しているか）
6. 冒頭の訴求力（読者の関心を引いているか）
7. 前後の章との繋がり（既存の他章がある場合）
8. Kindle最適化（段落の長さ、見出し階層、箇条書きの活用）
9. 文字数（3,000〜5,000文字の範囲内か）

【出力】
校閲レポートを books/{slug}/reviews/edit-ch{NN}.md に書き込むこと。
形式:
## 第{N}章 校閲レポート

### 総合評価: ★★★★☆（5段階）

### 良い点
- ...

### 要改善事項
- [ ] 指摘1: 説明（重要度: 高/中/低）
- [ ] 指摘2: ...

### 具体的な修正提案
1. 該当箇所の引用 → 修正案

※ 内容の修正はファイルに直接書き込まないこと（校正者の修正と衝突するため）。
  レポートに修正提案として記載するに留める。
```

### Phase 2: 編集長による統合レビュー

校正者・校閲者の両方が完了後に起動する：
- `subagent_type: "general-purpose"`

```
あなたは編集長です。校正者と校閲者のレポートを統合し、最終判断を行ってください。

【対象章】books/{slug}/chapters/{NN}-chapter.md
【校正レポート】books/{slug}/reviews/proofread-ch{NN}.md
【校閲レポート】books/{slug}/reviews/edit-ch{NN}.md

【指示】
1. 校正者による修正済みファイルを確認する
2. 校閲者の指摘事項のうち、対応すべきものを判断する
3. 重要度「高」の指摘は必ず反映する
4. 反映すべき修正を本文に適用する
5. フロントマターの reviewed_by に ["proofreader", "content_editor", "editor_in_chief"] を追加する
6. status を "review" に更新する
7. 最終的な判断サマリーをユーザーに返すこと
```

4. 全レビュー結果をユーザーに報告する
