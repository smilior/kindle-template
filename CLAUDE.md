# 電子書籍原稿作成プロジェクト

複数のKindle向け電子書籍の原稿をMarkdownで作成・管理するワークスペース。
出版社のプロフェッショナルチーム体制をAgent Teamsで再現し、高品質な原稿を効率的に生成する。

## プロジェクト構造

```
kindle-template/
├── CLAUDE.md                    # プロジェクト指示書（このファイル）
├── books/                       # 全書籍の格納ディレクトリ
│   ├── {book-slug}/             # 書籍ごとのディレクトリ（英数ケバブケース）
│   │   ├── book.yaml            # 書籍メタデータ
│   │   ├── outline.md           # アウトライン
│   │   ├── chapters/            # 章ファイル
│   │   │   ├── 00-introduction.md
│   │   │   ├── 01-chapter.md
│   │   │   └── ...
│   │   ├── assets/              # 画像・図表
│   │   ├── reviews/             # レビュー記録
│   │   │   └── review-ch01.md
│   │   └── manuscript.md        # 結合済み原稿（自動生成）
│   └── {another-book-slug}/
│       └── ...
└── .claude/
    └── skills/                  # スキル定義
```

## 書籍スラッグの規則
- 英数小文字とハイフンのみ使用（例: `ai-business-guide`, `side-hustle-101`）
- スラッグは `book.yaml` の `slug` フィールドと一致させる
- 全スキルは引数として書籍スラッグを受け取る（例: `/ebook-write ai-business-guide 3`）

## book.yaml の形式
```yaml
slug: "ai-business-guide"
title: "書籍タイトル"
subtitle: "サブタイトル（任意）"
author: "著者名"
language: ja
description: |
  書籍の概要説明
target_audience: "想定読者"
genre: "ジャンル"
tone: "です・ます"   # です・ます | だ・である
total_chapters: 8
word_count_target: 20000
status: draft        # draft | in_progress | review | complete
created_at: "2026-02-02"
```

## 章ファイルの規則

### 命名規則
- `00-introduction.md` — はじめに
- `01-chapter.md` ～ `NN-chapter.md` — 各章
- `99-afterword.md` — あとがき

### フロントマター
```markdown
---
chapter: 1
title: "章タイトル"
status: draft       # draft | writing | review | complete
word_count: 0
reviewed_by: []     # レビュー済みの役割リスト
---
```

## 文章スタイルガイド
- 一文は60文字以内を目安
- 段落間は空行で区切る
- 専門用語は初出時に説明を入れる
- book.yaml の `tone` で指定した文体を書籍内で統一する
- 読者に語りかける文体を基本とする
- 箇条書きや見出しを活用して可読性を高める
- Kindle向け横書き前提
- 短い段落を心がける（スマホでの可読性）
- 太字（**強調**）を効果的に使う

## 文字数の目安
- 書籍全体: 20,000文字前後（18,000〜22,000文字）を標準とする
- 1章あたり: 1,500〜2,500文字（章数に応じて調整）
- はじめに・あとがき: 各800〜1,500文字
- book.yaml の word_count_target で書籍ごとに上書き可能（デフォルト: 20,000）

---

## ベストプラクティス（市場で勝てる書籍設計ルール）

本プロジェクトで作成する全書籍は、以下のルールに従うこと。
「書きたいことを書く」のではなく「読者が求めるものを高品質な商品として提供する」ことが原則。

### 1. テーマ選定ルール

#### HARMの法則
テーマは人間の根源的な悩み「HARM」に該当するものを優先する：

| カテゴリ | テーマ例 | 具体的切り口 |
|---------|---------|------------|
| **Money**（お金） | 副業、投資、節約、家計管理 | 「未経験から月3万円稼ぐ方法」 |
| **Health**（健康） | ダイエット、メンタルヘルス、健康法 | 「運動なしで痩せる」「ルーティンによるメンタルケア」 |
| **Ambition**（夢・キャリア） | 時間管理、目標達成、習慣化、転職 | 「忙しい人のための時間管理術」 |
| **Relation**（人間関係） | 恋愛、婚活、育児、コミュニケーション | 「子育て中の主婦向けの在宅ワーク入門」 |

#### ニッチ戦略（必須）
大きな括り（ビッグワード）は避け、ターゲットを細分化する：
- **掛け合わせの公式**: 「ターゲット × ベネフィット × 手法」
  - 悪い例: 「ダイエット法」
  - 良い例: 「残業続きの営業マンが3ヶ月で10kg痩せた方法」
- 競合が少ないサブカテゴリを狙う（カテゴリ内の競合が10冊未満が理想）
- 特定のツール・環境・ライフステージに特化する

#### 実体験・ストーリー重視
AI時代において、単なる情報の羅列は差別化できない：
- 著者独自の「失敗談」「克服体験」を必ず含める
- 心理描写を深く、読者の感情を動かす構成にする
- 「問題提起 → 共感 → 小さな成功体験」のストーリー設計を基本とする

#### シリーズ化の視点
1冊で終わらせず、長期的に読まれる設計にする：
- 段階的に学べる構成（「入門」→「実践編」など）を意識する
- 短編連作形式でファンを作り、後に合本版としてまとめられるテーマを選ぶ

### 2. コンセプト設計ルール

#### BDF分析（必須）
企画段階で読者の深層心理を以下の3軸で整理し、`book.yaml` の `bdf` フィールドに記録する：

| 要素 | 意味 | 例 |
|------|------|------|
| **Belief**（信念・思い込み） | 読者の固定観念 | 「投資は怖い」「副業は時間がないと無理」 |
| **Desire**（欲求） | 本当はどうなりたいか | 「働かずに稼ぎたい」「家族との時間を増やしたい」 |
| **Feeling**（感情） | 現状に対する感情 | 「将来が不安」「損をしたくない」 |

#### 差別化コンセプトの公式
```
「[Belief]を否定し、[Desire]を叶えるための、[独自の解決策]を提供する本」
```

#### 書籍の位置づけ
- 印税目的ではなく「集客・ブランディング装置」として設計する
- バックエンド（高単価商品・コミュニティ・メルマガ等）への導線を前提に構成する

### 3. タイトル設計ルール

#### タイトルの公式（必須）
```
[ターゲット] × [ベネフィット（数字・期間）] × [権威性・簡易性]
```
- 悪い例: 「人生を変える思考法」（抽象的すぎる）
- 良い例: 「30代会社員が副業で月10万円稼ぐKindle出版：1日30分の作業で資産を作る」

#### 9つの訴求要素
タイトル・サブタイトルには以下の要素を可能な限り盛り込む：
1. ベネフィット（読むとどうなるか）
2. 期間（「たった○日で」）
3. 簡易性（「○○するだけ」）
4. 権威性（「プロが教える」「元○○が語る」）
5. 限定性（「今だけ」「○○な人だけ」）
6. 具体的な数字（「月10万円」「3ヶ月で」）
7. ターゲットの明示（「30代会社員」「忙しい主婦」）
8. 好奇心の刺激（「なぜ○○は□□なのか」）
9. 緊急性（「知らないと損する」）

#### Amazon SEO対策
- 読者が実際に検索するキーワードをタイトル・サブタイトルに含める
- Amazonサジェストに出る語句を優先的に採用する
- KDP管理画面の7つのキーワード枠にも関連語を設定する想定でテーマを選ぶ

### 4. 原稿構成ルール（読了率の最大化）

Kindle Unlimited（読み放題）ではKENP（既読ページ数）が収益に直結するため、**最後まで読ませる構成**が最重要。

#### 3つの壁を超える構成（必須）
読者には「読まない壁・信じない壁・行動しない壁」がある。構成でこれを突破する：

**序章（はじめに）— 「読まない壁」の突破**
- 共感と問題提起: BDFに基づいた悩みを提示し「この本はあなたのための本だ」と確信させる
- ベネフィットの提示: この本を読むとどうなれるか（結論）を最初に示し、離脱を防ぐ

**本編 — 「信じない壁」の突破**
- 権威性と証拠: 著者の実績、体験談、データを用いて信頼を得る
- ノウハウの惜しみない開示: ただし「詳細な手順」「ワークシート」等はバックエンドへ残す

**終章（あとがき）— 「行動しない壁」の突破**
- 読者への行動喚起を明確に行う
- バックエンドへの誘導: 読者限定特典（動画解説・テンプレート等）をオファーし、LINE・メルマガ等へ誘導する

#### 構成テンプレート
ジャンルに応じて以下のいずれかを採用する：

**問題解決型（実用書向け）**
1. 序章: この本で解決できる未来の提示
2. 第1章: なぜその問題が起きるのか（原因）
3. 第2章: 解決の基本原則
4. 第3〜6章: 実践ステップ（具体的手法）
5. 第7〜8章: 応用・発展
6. 終章: 読者への行動喚起

**ストーリー型（体験談向け）**
1. 悩み・どん底の状態
2. 出会い・気づき
3. 実践・失敗の繰り返し
4. 成功・変化
5. 読者へのメッセージ

#### ブリッジ（章末予告）の義務化
各章の最後に「次章ではさらに○○について解説します」という予告を入れ、離脱を防ぐ。

#### 巻末の必須要素
1. **レビュー依頼文**: 「少しでも役に立ったら、星評価だけでもお願いします」という丁寧な依頼
2. **読者限定特典オファー**: バックエンドへの導線（URL・QRコード等のプレースホルダ）
3. **著者プロフィール**: 権威性と親近感を両立した紹介文

### 5. 品質管理ルール

#### Kindleフォーマット最適化（リフロー型）
- 特別な理由がない限り**リフロー型**（文字サイズ変更可能）で作成する
- 文字色を白や黒に固定しない（ダークモード対応）
- ページ番号を本文に手入力しない（端末依存のため）
- 画像を使用する場合は画質を確認する（ぼやけNG）

#### 校正の徹底
- 誤字脱字は最も多い低評価の原因であり、徹底排除する
- `/ebook-review` の校正者メンバーが自動で検出するが、校閲者も二重チェックする

#### レビューに関する禁止事項
- 家族・友人へのレビュー依頼は**禁止**（Amazon規約違反）
- 対価を渡してのレビュー取得は**禁止**（アカウント停止リスク）
- レビューは「巻末依頼文」と「作品の品質」で自然獲得する

### 6. 設計チェックリスト

全書籍は以下のチェックリストを満たすこと。`/ebook-review` の校閲者がこのリストに基づいて最終確認する：

- [ ] テーマがHARMの法則に該当しているか
- [ ] ニッチ戦略（ターゲット × ベネフィット × 手法）で差別化されているか
- [ ] BDF分析が完了し、コンセプトが読者の深層心理に刺さるか
- [ ] タイトルにSEOキーワードと具体的ベネフィットが含まれているか
- [ ] 序章で「読まない壁」を突破する構成になっているか
- [ ] 各章末にブリッジ（次章予告）が入っているか
- [ ] 巻末にレビュー依頼文と特典オファーがあるか
- [ ] 著者の実体験・ストーリーが盛り込まれているか
- [ ] 誤字脱字・表記ゆれが排除されているか
- [ ] リフロー型フォーマットのルールに準拠しているか

## book.yaml の拡張フィールド

上記ルールに対応するため、book.yaml には以下の戦略フィールドも記録する：
```yaml
# --- 戦略設計 ---
harm_category: "Money"       # HARM分類: Money | Health | Ambition | Relation
niche_target: "残業続きの30代営業マン"  # ニッチターゲット
bdf:
  belief: "副業は時間がないと無理"      # 読者の思い込み
  desire: "本業以外の収入源がほしい"    # 読者の本当の欲求
  feeling: "将来が不安、現状を変えたい"  # 読者の感情
differentiation: "著者が営業マン時代に実践した方法"  # 差別化要素
backend_offer: "LINE登録で副業テンプレート配布"      # バックエンド導線
keywords:                    # Amazon SEO用キーワード（最大7つ）
  - "副業 会社員"
  - "副業 始め方"
  - "サラリーマン 副収入"
structure_type: "problem-solving"  # problem-solving | story
```

---

## プロフェッショナルチーム体制

出版社の制作チームを再現する6つの専門役割を定義する。
各役割はAgent Teamsのチームメンバーとして動作し、共有タスクリストと直接通信で効率化する。

### 役割一覧

| 役割 | 英名 | 責務 |
|------|------|------|
| 編集長 | Editor-in-Chief | 書籍全体の方向性・品質の最終責任者。企画承認、構成監修、全体の一貫性を担保 |
| 構成作家 | Structure Writer | 章立て・アウトライン設計。読者の導線と論理構成を設計する |
| ライター | Writer | 本文の執筆。アウトラインに沿って読みやすい文章を書く |
| 校正者 | Proofreader | 文字レベルの品質管理。誤字脱字・文法ミス・表記ゆれを修正する |
| 校閲者 | Content Editor | 内容レベルの品質管理。事実確認・論理矛盾・構成の飛躍を指摘する |
| 仕上げ担当 | Finalizer | 原稿の最終整形。目次生成・奥付作成・Kindle向けフォーマット最適化 |

### Agent Teamsの使い方

各役割は Agent Teams のチームメンバーとして起動する。
書籍ごとに1つのチーム（`ebook-{slug}`）を作成し、共有タスクリストで進捗を管理する。

#### チーム管理
- `TeamCreate` でチームを作成する（チームリーダー = メインエージェント）
- `Task` ツールに `team_name` と `name` を指定してメンバーを起動する
- `SendMessage` でメンバーに指示・フィードバックを送信する
- メンバー完了後は `SendMessage(type="shutdown_request")` で終了させる
- 全工程完了後に `TeamDelete` でチームリソースを削除する

#### チームライフサイクル
```
/ebook-outline      TeamCreate("ebook-{slug}") → 構成作家 + 編集長を起動
     ↓
/ebook-write        チーム再利用 → ライター×N章を起動
     ↓
/ebook-review       チーム再利用 → 校正者 + 校閲者を起動（編集長は存続）
     ↓
/ebook-build        チーム再利用 → 仕上げ担当を起動 → 全員シャットダウン → TeamDelete
```

#### メンバー起動・終了タイミング
| メンバー名 | 起動 | 終了 | 理由 |
|-----------|------|------|------|
| `editor-in-chief` | outline | build後 | 全工程で品質監督 |
| `structure-writer` | outline | outline後 | 構成完了で役目終了 |
| `writer-ch{NN}` | write | write後 | 章単位の短命エージェント |
| `proofreader` | review | review後 | 全章校正を順次処理 |
| `content-editor` | review | review後 | 全章校閲を順次処理 |
| `finalizer` | build | build後 | 結合完了で役目終了 |

#### タスク管理
- `TaskCreate` でフェーズごとのタスクを作成する
- `TaskUpdate` で担当者（owner）・依存関係（blockedBy）を設定する
- メンバーは `TaskUpdate` で自タスクを in_progress → completed と更新する
- チームリーダーは `TaskList` で進捗を監視し、フェーズ遷移を判断する

#### メンバー間通信
- `SendMessage(type="message")` で直接メッセージを送受信できる
- ライターは編集長にアウトラインの疑問を質問できる
- 編集長はライター・校正者・校閲者に直接フィードバックを送れる
- 校閲者は重大な内容問題を編集長に即座にエスカレーションできる

#### メンバー起動プロンプトの共通ルール
各メンバーの起動プロンプトには以下を必ず含める：

1. **役割の明示**: 「あなたは{役割名}です」
2. **書籍情報**: book.yaml の内容
3. **対象ファイル**: 操作する章ファイルのパス
4. **具体的な指示**: その役割に応じたタスク内容
5. **出力先**: 結果を書き込むファイルパス
6. **チーム作業ルール**:
   - TaskList で自分に割り当てられたタスクを確認すること
   - 作業開始時に TaskUpdate(status="in_progress") を実行すること
   - 作業完了時に TaskUpdate(status="completed") を実行すること
   - 疑問や問題がある場合は SendMessage で適切なメンバーに連絡すること

### 並列実行の原則

- **並列可能**: 複数章の同時執筆、複数章の同時校正、校正と校閲の同時実行
- **直列必須**: アウトライン → 執筆 → レビュー → 仕上げ（工程間は依存あり）
- **タスク依存関係で自動制御**: TaskUpdate の blockedBy で依存関係を設定し、前工程の完了をタスクリストで自動追跡する

## Gitブランチ運用

原稿の作成はGitのfeatureブランチ上で行い、完成後にプルリクエスト（PR）でmainにマージする。

### ブランチ命名規則
- `feature/{slug}` — 書籍の制作ブランチ（例: `feature/ai-business-guide`）
- `main` — 完成原稿のみが存在するブランチ

### ブランチライフサイクル

```
main ─────────────────────────────────────── merge ← PR
  └── feature/{slug} ── outline ── write ── review ── build ── PR
```

1. `/ebook-init` 実行時に `feature/{slug}` ブランチを作成・チェックアウトする
2. 各工程の完了時に自動コミットする：
   - アウトライン完成 → コミット
   - 各章の執筆完了 → コミット
   - レビュー完了 → コミット
   - 原稿結合完了 → コミット
3. `/ebook-pr` でプルリクエストを作成する
4. PRマージ後、featureブランチは削除する

### コミットメッセージ規則
```
[{slug}] {工程}: {内容}
```
例：
- `[ai-business-guide] outline: アウトライン作成`
- `[ai-business-guide] write: 第1章〜第5章 執筆完了`
- `[ai-business-guide] review: 全章レビュー完了`
- `[ai-business-guide] build: 原稿結合完了`

### PRルール（重要）
- **PRを作成する前に、必ず `/ebook-review` によるレビュー工程を完了すること**
- 全章の `reviewed_by` に `editor_in_chief` が含まれていない場合、PRは作成できない
- PRのタイトル: `{書籍タイトル} — 原稿完成`
- PRの本文には制作完了レポート（文字数統計・レビュー状況）を含める

## ワークフロー

```
/ebook-idea         テーマ発見・市場調査（任意。テーマ未定時に実行）
     ↓
/ebook-init         書籍プロジェクト初期化 + featureブランチ作成
     ↓
/ebook-outline      アウトライン作成（構成作家 + 編集長）→ コミット
     ↓
/ebook-write        章の執筆（ライター × 並列）→ コミット
     ↓
/ebook-review       校正・校閲（校正者 + 校閲者 × 並列）→ コミット ★PR前に必須
     ↓
/ebook-build        原稿結合・仕上げ（仕上げ担当）→ コミット
     ↓
/ebook-pr           プルリクエスト作成（レビュー済みチェック付き）
     ↓
/ebook-status       書籍の進捗確認
/ebook-list         管理中の書籍一覧
/ebook-produce      全工程一括実行（企画→PR作成まで自動）
```

---

## 実行規律（止まらない仕組み）

ワークフローの途中で停止してユーザーの入力を待つことは**厳禁**。
以下のルールに従い、指示された作業が完了するまで自律的に実行し続けること。

### 基本原則

1. **工程間で止まらない**: outline → write → review → build → commit → push は一連の流れとして中断なく実行する
2. **ユーザーに確認を求めない**: 作業中に「次に進めますか？」「どうしますか？」等の確認は不要。指示された作業を最後まで完遂する
3. **中間報告で止まらない**: メンバーの結果を受け取ったら、報告のみで止まらず即座に次の工程のメンバーを起動する
4. **エラー時のみ停止**: 致命的なエラー（ファイルが存在しない、権限エラー等）が発生した場合のみユーザーに報告して停止する

### メンバー起動の連続性ルール

```
メンバー完了 → 結果確認 → 即座に次のメンバー起動（同一メッセージ内）
```

- メンバーの結果を受け取ったら、**同じレスポンス内で**次の工程のメンバーを起動すること
- 「結果を報告して終了」ではなく「結果を確認し、次のアクションを実行して終了」を徹底する
- 並列実行可能なメンバーは必ず1つのメッセージ内で同時に起動する

### コミット・プッシュの自動化

各工程の完了時に自動でコミット・プッシュする。ユーザーの許可は不要：
- アウトライン完成 → 即コミット → 即次工程
- 執筆完了 → 即コミット → 即次工程
- レビュー完了 → 即コミット → 即次工程
- 原稿結合完了 → 即コミット＆プッシュ

### 禁止パターン

以下のパターンは明確に禁止する：

| 禁止パターン | 正しい行動 |
|-------------|-----------|
| メンバー完了後「次に進めます」と報告して停止 | 報告せず即座に次のメンバーを起動 |
| 「アウトラインが完成しました。執筆に進みますか？」 | アウトライン完成 → 即座にライターメンバーを起動 |
| 中間結果をユーザーに見せて反応を待つ | 中間結果は内部で処理し、最終結果のみ報告 |
| 1冊ずつ順番に完成させる（複数冊の場合） | 全冊を各工程で並列処理する |

### 最終報告のタイミング

ユーザーへの報告は**全工程が完了し、コミット・プッシュまで終わった後**に1回だけ行う。
報告には以下を含める：
- 完成した書籍の一覧
- 各書籍の文字数統計
- コミットハッシュとプッシュ先ブランチ

### チームリソースの管理

- 各工程のメンバーは完了後に必ずシャットダウンする（編集長は例外: build完了まで持続）
- `TeamDelete` は全メンバーが終了した後に呼び出すこと
- チームが既に存在する場合は再利用し、二重作成しないこと
- チーム名は `ebook-{slug}` で統一する
